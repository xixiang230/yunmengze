---
title: 提升SQL执行效率的书写方法
date: 2016-07-16 12:14:20
tags: [SQL]
categories: [技术]
---
# 背景原理
SQL语句是一个抽象概念，而不代表具体的实现。具体如何执行SQL在关系数据库中都有一个所谓的优化器实现，现代关系数据库的优化器是基于成本来选择具体执行步骤的，因此妨碍优化器选择最优执行步骤的SQL都不是好SQL。所有当尝试写性能优越的SQL时要坚持: Think like query optimizer, not like programmer，学会用数据库的方式来思考如何执行SQL。    
1. 尽量不要在where中包含子查询和出现各种花样百出的函数和运算等。
2. 在过滤条件中，可以过滤掉最大数量记录的条件必须放在where子句的末尾。  
4. 在where中尽量不要使用OR。
5. 用EXISTS代替IN，用NOT EXISTS代替NOT IN。
6. 避免在索引列上使用计算。  
7. 用IN来代替OR。  
8. 避免在索引列上使用IS NULL和IS NOT NULL。  
9. 总是使用索引的第一个列。  
10. 优化GROUP BY。  
11. 避免带有LIKE参数的通配符。  
12. 避免使用困难的正则表达式。  
13. 尽量明确完成SQL语句，尽量少让数据库工作。比如写SELECT语句时，需要把查询的字段明确指出，不要使用SELECT *语句。这里数据库会将'*'依次转换成所有列名，该工作通过查询数据字典完成，但该过程的时间成本可忽略不计。更多的耗时是在于:(a)读取多余的列可能导致索引的书签查找，当读取条目多时会无法使用特定索引。(b)如果用select * 作用于表连接，可能造成更大的成本开销。   
14.
避免语句过大，大量的表join会导致中间结果不准确，从而限制优化器选择较好的执行计划。   
